<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled 1</title>
<link rel="stylesheet" type="text/css" href="/coupon/common/css/style.css" />
<link rel="stylesheet" type="text/css" href="/coupon/res/js/uploadify.css" />
<link rel="stylesheet" type="text/css" href="/coupon/res/js/fileuploader.css" />
<script type="text/javascript" src="/coupon/res/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/coupon/res/js/swfobject.js"></script>
<script type="text/javascript" src="/coupon/res/js/jquery.uploadify.v2.1.4.min.js"></script>
<script type="text/javascript" src="/coupon/res/js/kindeditor-min.js"></script>
<script type="text/javascript" src="/coupon/res/js/zh_CN.js"></script>
<script language="javascript" type="text/javascript" src="/coupon/res/js/WdatePicker.js"></script>
<script language="javascript" type="text/javascript" src="/coupon/res/js/jquery.validate.min.js"></script>
  <body>
<script type="text/javascript">
function onComplete(event, ID, fileObj, response, data){
	var json= eval("(" + response + ")");
	var upImg=json.upImg;
	
	var imageId=json.imageId;
	var success=json.success;
	
	if(success==true){
      	$("#upImg"+upImg).parent().prev().html("<span><img src=\"/coupon/goods0/img/"+json.picname +"\"alt=\"\" width=\"200\" height=\"200\"/></span>"+"<input type=\"hidden\" name=\"pic_url\" value=\""+json.picname+"\"/>");

    }else{
  	    alert("上传失败");
    }
}

function onCompleteErwei(event, ID, fileObj, response, data){
	var json= eval("(" + response + ")");
	var upImg=json.upImg;
	
	var imageId=json.imageId;
	var success=json.success;
	
	if(success==true){
      	$("#erwei"+upImg).parent().prev().html("<span><img src=\"/coupon/goods0/img/"+json.picname +"\"alt=\"\" width=\"200\" height=\"200\"/></span>"+"<input type=\"hidden\" name=\"ercode\" value=\""+json.picname+"\"/>");

    }else{
  	    alert("上传失败");
    }
}
$(document).ready(function() {

  $('#file_upload1').uploadify({

    'uploader'  : '/coupon/res/js/uploadify.swf',

    'script'    : '/coupon/admin/goods/upload',

    'cancelImg' : '/coupon/res/js/cancel.png',
    'scriptData'  : {'upImg':'1','age':30},
    'folder'    : '/uploads',
	'onComplete':function(event, ID, fileObj, response, data) {onComplete(event, ID, fileObj, response, data);},
    'auto'      : true

  });

 
  $('#erwei').uploadify({

	    'uploader'  : '/coupon/res/js/uploadify.swf',

	    'script'    : '/coupon/admin/goods/upload',

	    'cancelImg' : '/coupon/res/js/cancel.png',

	    'folder'    : '/uploads',
	    'scriptData'  : {'upImg':'1','age':30},
	    'folder'    : '/uploads',
		'onComplete':function(event, ID, fileObj, response, data) {onCompleteErwei(event, ID, fileObj, response, data);},
	    'auto'      : true

	  });


  $('#file_upload3').uploadify({

	    'uploader'  : '/gfsns/goods/js/uploadify.swf',

	    'script'    : '/gfsns/goodsjson/goods_save',

	    'cancelImg' : '/gfsns/goods/js/cancel.png',

	    'folder'    : '/uploads',
	    'scriptData'  : {'upImg':'3','age':30},
	    'folder'    : '/uploads',
		'onComplete':function(event, ID, fileObj, response, data) {onComplete(event, ID, fileObj, response, data);},
	    'auto'      : true

	  });



  $('#file_upload4').uploadify({

	    'uploader'  : '/gfsns/goods/js/uploadify.swf',

	    'script'    : '/gfsns/goodsjson/goods_save',

	    'cancelImg' : '/gfsns/goods/js/cancel.png',

	    'folder'    : '/uploads',
	    'scriptData'  : {'upImg':'4','age':30},
	    'folder'    : '/uploads',
		'onComplete':function(event, ID, fileObj, response, data) {onComplete(event, ID, fileObj, response, data);},
	    'auto'      : true

	  });


  $('#file_upload5').uploadify({

	    'uploader'  : '/gfsns/goods/js/uploadify.swf',

	    'script'    : '/gfsns/goodsjson/goods_save',

	    'cancelImg' : '/gfsns/goods/js/cancel.png',

	    'folder'    : '/uploads',
	    'scriptData'  : {'upImg':'5','age':30},
	    'folder'    : '/uploads',
		'onComplete':function(event, ID, fileObj, response, data) {onComplete(event, ID, fileObj, response, data);},
	    'auto'      : true

	  });
  

});

</script>

 <script src="/coupon/res/js/fileuploader.js" type="text/javascript"></script>
    <script> 
	
   
       var uploaders = new qq.FileUploaderBasic({
            action: "/gfsns/goodsjson/goods_save",
            debug: false,
            onComplete: function(id, fileName, responseJSON){
            if(responseJSON.success==true){
            	callBack(id,responseJSON.fileFileName,responseJSON.imageId,responseJSON.success,responseJSON.upImg);
               }
            	else{
                	alert(responseJSON.error);
            	}

            }
        }); 
        function beginUpload(obj){
        	 var input = $(obj).prev().get(0);
        	 uploaders.setParams({
          		upImg:$(obj).parent().attr("id")

          	})
        	if (uploaders._handler instanceof qq.UploadHandlerXhr){ 
            	alert(input.files);               
        		uploaders._uploadFileList(input.files);                   
            } else {             
                if (uploaders._validateFile(input)){                
                	uploaders._uploadFile(input);                                    
                }                      
            }    	
        }
    function remove(obj){
			$(obj).parent().html("<span style=\"color:red;\">已删除</span>")	
     }
    function callBack(id,name,imageId,success,upImg){
        if(success==true){
                var ImgIndex=upImg.substring(5,6);
            	//$("#"+upImg).empty();
            	$("#"+upImg).parent().prev().html("<span><img src=\"/gfsns/goods/img_viewById?imageNum="+imageId+"&size=152\" alt=\"\"/></span>"+"<input type=\"hidden\" name=\"imageId["+(ImgIndex-1)+"]\" value=\""+imageId+"\"/>");
            	alert(name+"上传成功");
          }else{
        	    alert(name+"上传失败");
          }

        }    
    /**    function createUploader(){            
            var uploader = new qq.FileUploader({
                element: document.getElementById('upload'),
                action: "/gfsns/goodsjson/goods_save",
                debug: true,
                onComplete: function(id, fileName, responseJSON){
                if(responseJSON.success==true){
                	callBack(id,responseJSON.fileFileName,responseJSON.imageId);
                   }
                	else{
                    	alert(responseJSON.error);
                	}
	
                }
            }); 
             uploader.setParams({
         		fileFileName: 'value' 
         	})          
        }**/

        	        
        // in your app create uploader as soon as the DOM is ready
        // don't wait for the window to load     
    </script>


</head>
<body>

  #if( $a ==3 ) 
     <div id="goodsadd" class="goodsadd" style="margin-top:50px;padding:10px;">
   <form action="activityAction?a=2" method="post">
   		<input type="hidden" value="$!{activity.id}" name="id"/>
		<input type="hidden" value="$!{activity.isverified}" name="isverified"/>
	

	
   <table cellspacing="1" cellpadding="2" border="0" bgcolor="#d1ddaa" align="center" width="98%" style="margin-top: 8px;">
   		<tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动标题</td>
   			<td><input type="text" class="text_cls" value="$!{activity.title}" name="title"/></td>
   		</tr>
   		
   		<tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动内容</td>
   			<td><input type="text" class="text_cls" value="$!{activity.content}" name="content"/></td>
   		</tr>
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动开始时间</td>
   			<td><input type="text"  value="$!date.format('yyyy-MM-dd HH:mm:ss ',$!activity.begin_time)" name="begin_time1" onClick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss'})"/></td>
   		</tr>
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动结束时间</td>
   			<td><input type="text" onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss'})" value="$!date.format('yyyy-MM-dd HH:mm:ss ',$!activity.end_time)" name="end_time1" ></td>
   		</tr>
   		  
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动地点</td>
   			<td><input type="text" class="text_cls" value="$!{activity.act_address}" name="act_address"/></td>
   		</tr>
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>关键词</td>
   			<td><input type="text" class="text_cls" value="$!{activity.keyword}" name="keyword"/></td>
   		</tr>
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>所属商圈</td>
   			<td><select style="width:120px;"  name="belong_bc">
				            <option value="0" selected="selected">所有商圈</option>
				             #foreach($obj in $bussinessCircleList)
							<option  value="${obj.id}" #if(${obj.id}==${activity.belong_bc}) selected="true" #end>${obj.bc_name}</option>
							 #end
				        </select></td>
   		</tr>
   		
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>所属分类</td>
   			<td> <select style="width:80px;"  name="belong_cat">
				            <option value="0" selected="selected">所有分类</option>
				            #foreach($obj in $shopCategoryList) 
				            <option value="${obj.category_id}" #if(${obj.category_id}==${activity.belong_cat}) selected="true" #end>${obj.category_name}</option>
				            #end
				        </select>  </td>
   		</tr>
   		<tr height="22" bgcolor="#fafaf1" align="left">
   			<td>所属商户</td>
   			<td><select style="width:80px;"  name="belong_shop">
				            <option value="0" selected="selected">所有商户</option>
				            #foreach($obj in $shopList) 
				            <option value="${obj.id}" #if(${obj.id}==${activity.shop_id}) selected="true" #end>${obj.name}</option>
				            #end
				        </select></td>
   		</tr>

   		
   	
   		
   		
		<tr height="22" bgcolor="#fafaf1" align="center">
   			<td>默认图片1</td>
   			<td>
   			#if(${activity.pic_url})
   			<p class="prew_img"><img src="/coupon/goods0/img/$!{activity.pic_url}" alt="" width="200" height="200"/>
   			<input type="hidden" value="$!{activity.pic_url}" name="pic_url"/>
   			</p>
   			<p class="inputForm">
   			<span id="upImg1">
      		<input id="file_upload1" name="file" type="file"/>
   			<!--<input type="button" value="上传" onclick="beginUpload(this);"/>-->
   			<!-- <a href="javascript:;" onclick="beginUpload(this);">上传</a>-->
   			</span>
   			</p>
   			#else
   			
   			<p class="wait_img">等待上传图片</p>
   			<p class="inputForm"><span id="upImg1"><input type="file" value="" name="file" id="file_upload1"/>
   			<!-- <a href="javascript:;" onclick="beginUpload(this);">上传</a>--></span>
   			</p>
   			#end
   			</td>
   		</tr>
   		  <tr height="22" bgcolor="#fafaf1" align="center">
   			<td></td>
   			<td><input type="submit" value="保存"/> 
			<input type="button" value="返回 " onclick="history.go(-1)"/> </td>
   		</tr>
   			
   </div>

</form>

#end




  #if( $a ==4 ) 
     <div id="goodsadd" class="goodsadd" style="margin-top:50px;padding:10px;">
   <form action="activityAction?a=1" method="post">
   		<input type="hidden" value="$!{activity.id}" name="id"/>
	
	

	
   <table cellspacing="1" cellpadding="2" border="0" bgcolor="#d1ddaa" align="center" width="98%" style="margin-top: 8px;">
   		<tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动标题</td>
   			<td><input type="text" class="text_cls" value="$!{activity.title}" name="title"/></td>
   		</tr>
   		
   		<tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动内容</td>
   			<td><input type="text" class="text_cls" value="$!{activity.content}" name="content"/></td>
   		</tr>
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动开始时间</td>
   			<td><input type="text"  value="$!date.format('yyyy-MM-dd HH:mm:ss ',$!activity.begin_time)" name="begin_time1" onClick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss'})"/></td>
   		</tr>
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动结束时间</td>
   			<td><input type="text" onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss'})" value="$!date.format('yyyy-MM-dd HH:mm:ss ',$!activity.end_time)" name="end_time1" ></td>
   		</tr>
   		  
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>活动地点</td>
   			<td><input type="text" class="text_cls" value="$!{activity.act_address}" name="act_address"/></td>
   		</tr>
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>关键词</td>
   			<td><input type="text" class="text_cls" value="$!{activity.keyword}" name="keyword"/></td>
   		</tr>
   		  
   		  
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>所属商圈</td>
   			<td><select style="width:120px;"  name="belong_bc">
				            <option value="0" selected="selected">所有商圈</option>
				             #foreach($obj in $bussinessCircleList)
							<option style="color:RED;" value="${obj.id}" #if(${obj.id}==${activity.belong_bc}) selected="true" #end>${obj.bc_name}</option>
							 #end
				        </select></td>
   		</tr>
   		
   		  <tr height="22" bgcolor="#fafaf1" align="left">
   			<td>所属分类</td>
   			<td> <select style="width:80px;"  name="belong_cat">
				            <option value="0" selected="selected">所有分类</option>
				            #foreach($obj in $shopCategoryList) 
				            <option style="color:RED;" value="${obj.category_id}" #if(${obj.category_id}==${activity.belong_cat}) selected="true" #end>${obj.category_name}</option>
				            #end
				        </select>  </td>
   		</tr>
   		<tr height="22" bgcolor="#fafaf1" align="left">
   			<td>所属商户</td>
   			<td><select style="width:80px;"  name="belong_shop">
				            <option value="0" selected="selected">所有商户</option>
				            #foreach($obj in $shopList) 
				            <option value="${obj.id}" #if(${obj.id}==${activity.shop_id}) selected="true" #end>${obj.name}</option>
				            #end
				        </select></td>
   		</tr>
  
   		   <tr bgcolor="#ffffff">
      <td>是否是热门活动：</td>
       <td>是 <input type="radio" value="1" name="is_hot" #if($!{activity.is_hot}==1)checked="true" #end/>  否<input type="radio" value="0" name="is_hot" #if($!{activity.is_hot}==0)checked="true" #end/></td>
       </tr>
   		  
   		   <tr bgcolor="#ffffff">
      <td>是否是推荐活动：</td>
       <td>是 <input type="radio" value="1" name="is_recommend" #if($!{activity.is_recommend}==1)checked="true" #end/>  否<input type="radio" value="0" name="is_recommend" #if($!{activity.is_recommend}==0)checked="true" #end/></td>
       </tr>
   		
   		

   		
   		
		<tr height="22" bgcolor="#fafaf1" align="center">
   			<td>默认图片1</td>
   			<td>
   			#if(${activity.pic_url})
   			<p class="prew_img"><img src="/coupon/goods0/img/$!{activity.pic_url}" alt="" width="200" height="200"/>
   			<input type="hidden" value="$!{activity.pic_url}" name="pic_url"/>
   			</p>
   			<p class="inputForm">
   			<span id="upImg1">
      		<input id="file_upload1" name="file" type="file"/>
   			<!--<input type="button" value="上传" onclick="beginUpload(this);"/>-->
   			<!-- <a href="javascript:;" onclick="beginUpload(this);">上传</a>-->
   			</span>
   			</p>
   			#else
   			
   			<p class="wait_img">等待上传图片</p>
   			<p class="inputForm"><span id="upImg1"><input type="file" value="" name="file" id="file_upload1"/>
   			<!-- <a href="javascript:;" onclick="beginUpload(this);">上传</a>--></span>
   			</p>
   			#end
   			</td>
   		</tr>
   		  <tr height="22" bgcolor="#fafaf1" align="center">
   			<td></td>
   			<td><input type="submit" value="保存"/> 
			<input type="button" value="返回 " onclick="history.go(-1)"/> </td>
   		</tr>
   			
   </div>

</form>

#end
 
</body>
</html>